{% extends 'main/base.html' %}
{% block title %}Journal Officiel{% endblock%}

{% block content %}
<div class="container-fluid row bg-light">
    <!-- Entête -->
    <div class="text-center container">
        <div class="bg-white p-2 shadow border-bottom">
            <h2 class="text-center my-3">JOURNAL OFFICIEL DE LA REPUBLIQUE TOGOLAISE</h2>
            <small>Tous les demandes d'immatriculation sont affichés ici.</small>
            <div class="input-group my-3">
                <input type="text" class="form-control" placeholder="Rechercher" aria-label="Recipient's username"
                    aria-describedby="basic-addon2">
                <span class="input-group-text bg-success" id="basic-addon2"><i class="bi bi-search"></i></span>
            </div>
        </div>
    </div>


    <div class="row">
        <div class="row row-cols-1 row-cols-md-2 g-4">
            {% if requisitions %}
            {% for requisition in requisitions %}
            {% if requisition.state_set.first.state == 'A' %}
            <div class="col">
                <div class="card {% if requisition.author.username == user.username %}border-primary{% endif %}">
                    <div class="card-body">
                        {% include "requisition/includes/details.html" %}

                        {% if requisition.state_set.last.state == 'C' %}
                        <button class="btn btn-secondary">Rejetée</button>
                        {% else %}
                        {% if requisition.author.username != user.username %}
                        <a href="{% url 'add_complaint' number=requisition.number %}" class="text-decoration-none">
                            <button class="btn btn-danger text-white">S'opposer</button></a>
                        {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}
            {% endfor %}
            {% else %}
            <p class="text-center text-muted">Aucune réquisition n'a été fait</p>
            {% endif %}
        </div>
    </div>
    {% endblock%}